import{o as _,c as k,a as v,t as y,F as S,r as O,b as C,w as G,d as A,n as D,e as F,f as w,g as E,u as f,h as W,i as q,j as P,k as z,l as U,m as x,p as T,T as V,q as $,s as j,v as J,x as K}from"./vendor.3ea310d1.js";const H=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerpolicy&&(n.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?n.credentials="include":o.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}};H();const Q={class:"msg-box"},X={class:"game-name"},Y={class:"score"},Z={class:"tips"},ee={props:{name:String,btnName:String,tips:String,score:Number},emits:["init"],setup(e,{emit:t}){const a=()=>{t("init")};return(c,o)=>(_(),k("div",Q,[v("div",X,y(e.name),1),v("div",{class:"new-game",onClick:a},y(e.btnName),1),v("div",Y,"\u5206\u6570: "+y(e.score),1),v("div",Z,y(e.tips),1)]))}};const te={class:"game-box"},oe={class:"el-box"},ne={key:0,class:"game-over"},se=v("h1",null,"Game Over!",-1),ae=["onClick"],ce=v("h1",null,"\u8FDB\u5EA6\u5DF2\u4FDD\u5B58",-1),re=[ce],ie={props:{gameOver:{type:Boolean,default:!1},saveTips:{type:Boolean,default:!1}},emits:["reStart"],setup(e,{emit:t}){const a=()=>{t("reStart")};return(c,o)=>(_(),k("div",te,[(_(),k(S,null,O(16,n=>v("div",{class:"item",key:n})),64)),v("div",oe,[C(c.$slots,"default")]),e.gameOver?(_(),k("div",ne,[se,v("h3",{onClick:G(a,["stop"])},"\u518D\u6765\u4E00\u6B21",8,ae)])):A("",!0),v("div",{class:D(["game-save",{tips:e.saveTips}])},re,2)]))}};const le=["id"],ue={props:{block:Object},setup(e){const t=e,a=F({2:"#eee4da",4:"#ede0c8",8:"#f2b179",16:"#f59563",32:"#f67c5f",64:"#f65e3b",128:"#edcf72",256:"#edcc61",512:"#0444BF",1024:"#A79674",2048:"#282726",4096:"#280b21",8192:"#281d04"}),c=w(()=>{const o=t.block.num,n=o<=8192?a[o]:"#000",d=o>4&&"#fff",p=o>8192&&"22px",l=`${10+t.block.y*90}px`,s=`${10+t.block.x*90}px`;return{background:n,color:d,fontSize:p,position:"absolute",zIndex:t.block.id,top:l,left:s}});return(o,n)=>(_(),k("div",{class:"v-block",id:`b${e.block.id}`,style:E([f(c)])},y(e.block.num),13,le))}},de=W("main",{state:()=>({score:0,auxId:0,blocks:[],canMove:!0,gameOver:!1,timer:null,saveTips:!1,isFull:!1})});function I(e){return{getBlock:({x:a,y:c})=>e.blocks.find(o=>o.x===a&&o.y===c)}}const me=e=>{e.animate([{transform:"scale(0)"},{transform:"scale(1)"}],{duration:200})};function M(e){const{getBlock:t}=I(e);return{createBlock:()=>{if(e.isFull)return!1;const c=Math.floor(Math.random()*10)<8?2:4,o=()=>Math.floor(Math.random()*4),n={x:o(),y:o(),num:c,id:e.auxId++};for(;t({x:n.x,y:n.y});)n.x=o(),n.y=o();(p=>new Promise(l=>{e.blocks.push(p),l(!0)}))(n).then(()=>{const p=document.querySelector(`#b${n.id}`);me(p)})}}}function N(e){const{createBlock:t}=M(e),a=()=>{localStorage.clear(),e.$reset(),t(),t()};return{save:()=>{clearTimeout(e.timer),e.timer=null,e.timer=setTimeout(()=>{const n={score:e.score,blocks:e.blocks,auxId:e.auxId,gameOver:e.gameOver};localStorage.setItem("GameData",JSON.stringify(n)),e.saveTips=!0,clearTimeout(e.timer),e.timer=null},5e3)},load:()=>{const n=JSON.parse(localStorage.getItem("GameData"));n!==null?(e.score=n.score,e.blocks=n.blocks,e.auxId=n.auxId,e.gameOver=n.gameOver):a()},init:a}}function fe(e){const{getBlock:t}=I(e),{createBlock:a}=M(e),{save:c}=N(e),o=()=>{if(e.isFull){for(let l=0;l<4;l++){let s=e.blocks.filter(r=>r.y===l).sort((r,m)=>r.x-m.x);for(let r=0;r<4;r++){if(r<3&&s[r].num===s[r+1].num)return!1;if(l<3){let m=t({x:r,y:l+1});if(m!==void 0&&(m=m.num),s[r].num===m)return!1}}}return!0}else return!1},n=l=>e.blocks.findIndex(s=>s.id===l),d=l=>{l.animate([{transform:"scale(0)"},{transform:"scale(1.2)"},{transform:"scale(1)"}],{duration:150}),e.canMove=!0};return{blockMove:l=>{e.saveTips&&(e.saveTips=!1);const s=ve(l);let r=!1;for(let m=0;m<4;m++){let g=e.blocks.filter(i=>i[s.group]===m).sort((i,u)=>pe(s.end,i[s.coordinate],u[s.coordinate])),h=!1;for(let i=0;i<g.length;i++){let u=g[i],b=g[i-1];switch(i){case 0:u[s.coordinate]!==s.end&&(u[s.coordinate]=s.end,r=!0);break;default:if(u.num===b.num&&!h){u[s.coordinate]=b[s.coordinate],e.canMove=!1;const R=document.querySelector(`#b${u.id}`),L=document.querySelector(`#b${b.id}`);R.addEventListener("transitionend",()=>{e.score+=b.num*=2,d(L),e.blocks.splice(n(u.id),1),g.splice(i,1),i--}),r=!0,h=!0}else s.end===0?u[s.coordinate]!==g[i-1][s.coordinate]+1&&(u[s.coordinate]=b[s.coordinate]+1,r=!0,h=!1):u[s.coordinate]!==g[i-1][s.coordinate]-1&&(u[s.coordinate]=b[s.coordinate]-1,r=!0,h=!1);break}}}r&&a(),e.gameOver=o(),c()}}}const pe=(e,t,a)=>{switch(e){case 0:return t-a;case 3:return a-t}},ve=e=>{let t;switch(e){case"up":t={group:"x",coordinate:"y",end:0};break;case"down":t={group:"x",coordinate:"y",end:3};break;case"left":t={group:"y",coordinate:"x",end:0};break;case"right":t={group:"y",coordinate:"x",end:3};break}return t};function _e(e){const{blockMove:t}=fe(e),a=()=>t("up"),c=()=>t("down"),o=()=>t("left"),n=()=>t("right");return{keyBindings:()=>{document.addEventListener("keyup",p=>{if(!!e.canMove)switch(p.key.toLocaleUpperCase()){case"ARROWUP":case"W":a();break;case"ARROWDOWN":case"S":c();break;case"ARROWLEFT":case"A":o();break;case"ARROWRIGHT":case"D":n();break}})},moveUp:a,moveDown:c,moveLeft:o,moveRight:n}}const ge={class:"container"},ke={setup(e){const t=de(),{saveTips:a,gameOver:c,score:o}=q(t),{load:n,init:d}=N(t),{keyBindings:p,moveUp:l,moveDown:s,moveLeft:r,moveRight:m}=_e(t);return t.isFull=w(()=>t.blocks.length>15),P(()=>{p(),n()}),(g,h)=>{const i=z("touch");return U((_(),k("div",ge,[x(ee,{score:f(o),name:"2048-vue",btnName:"New Game",tips:"Tips: \u6E38\u620F\u8FDB\u5EA6\u5C06\u5728\u6700\u540E\u4E00\u6B21\u64CD\u4F5C\u540E5s\u4FDD\u5B58",onInit:f(d)},null,8,["score","onInit"]),x(ie,{gameOver:f(c),saveTips:f(a),onReStart:f(d)},{default:T(()=>[x(V,{name:"appear"},{default:T(()=>[(_(!0),k(S,null,O(f(t).blocks,u=>(_(),$(ue,{class:"block",key:u.id,block:u},null,8,["block"]))),128))]),_:1})]),_:1},8,["gameOver","saveTips","onReStart"])])),[[i,f(l),"swipe",{top:!0}],[i,f(s),"swipe",{bottom:!0}],[i,f(r),"swipe",{left:!0}],[i,f(m),"swipe",{right:!0}]])}}};const be={setup(e){return(t,a)=>(_(),$(ke))}},he=j(),B=J(be);B.use(he);B.use(K);B.mount("#app");
